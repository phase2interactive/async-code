# Task: Fix Authentication Vulnerability

**Priority**: CRITICAL
**Component**: Backend API & Frontend
**Security Impact**: High - Complete system compromise possible

## Problem
The current authentication system relies on unverified `X-User-ID` headers, allowing anyone to impersonate any user.

## Current Implementation Issues
- Backend accepts any user ID without verification (server/main.py)
- Frontend sends user ID in plaintext headers (async-code-web/lib/api-service.ts)
- No JWT token validation
- No session management

## Required Changes

### Backend Changes
1. Implement proper JWT token validation using Supabase Auth
2. Modify all endpoints to validate JWT tokens
3. Extract user ID from validated JWT claims
4. Remove reliance on `X-User-ID` header

### Frontend Changes
1. Send Supabase auth token in Authorization header
2. Remove `X-User-ID` header usage
3. Handle token refresh automatically

## Implementation Steps
1. Update server/main.py to add JWT validation middleware
2. Modify server/database.py to extract user from JWT
3. Update async-code-web/lib/api-service.ts to send auth tokens
4. Add proper error handling for auth failures
5. Test all endpoints for proper authentication

## Acceptance Criteria
- [ ] All API endpoints require valid JWT tokens
- [ ] User impersonation is no longer possible
- [ ] Proper 401/403 responses for auth failures
- [ ] Frontend handles auth errors gracefully